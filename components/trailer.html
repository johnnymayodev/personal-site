<!DOCTYPE html>
<div id="trailer"></div>

<style>
	#trailer {
		height: 20px;
		width: 20px;
		background-color: white;
		border-radius: 20px;

		position: fixed;
		left: 0px;
		top: 0px;
		z-index: 100;

		pointer-events: none;
		opacity: 0;
	}
</style>

<script>
	const trailer = document.getElementById("trailer");

	const mouseVelocity = {
		x: 0,
		y: 0,
		prevX: 0,
		prevY: 0,
		update: function (x, y) {
			this.prevX = this.x;
			this.prevY = this.y;
			this.x = x;
			this.y = y;
		},
		getVelocity: function () {
			return Math.sqrt(
				Math.pow(this.x - this.prevX, 2) + Math.pow(this.y - this.prevY, 2)
			);
		},
	};

	const animateTrailer = (e) => {

		const x = e.clientX - trailer.offsetWidth / 2;
		const y = e.clientY - trailer.offsetHeight / 2;

		const keyframes = {
			transform: `translate(${x}px, ${y}px) scale(${mouseVelocity.getVelocity() / 15 + 1})`,
			opacity: 1,
		};

		trailer.animate(keyframes, {
			duration: 800,
			fill: "forwards",
		});
	};

	window.onmousemove = (e) => {
		const x = e.clientX - trailer.offsetWidth / 2;
		const y = e.clientY - trailer.offsetHeight / 2;

		mouseVelocity.update(e.clientX, e.clientY);

		animateTrailer(e, mouseVelocity);

		if (e.target.classList.contains("trailer-interact")) {
			const keyframes = {
				transform: `translate(${x}px, ${y}px) scale(4)`,
			}

			trailer.animate(keyframes, {
				duration: 800,
				fill: "forwards",
			});
		} else {
			const keyframes = {
				transform: `translate(${x}px, ${y}px) scale(1)`,
			}

			trailer.animate(keyframes, {
				duration: 800,
				fill: "forwards",
			});
		}

	};
</script>